<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    version="5.0">
    <title>tvpvrd</title>
    <refentry xml:id="tvpvrd">
        <info>
            <author>
                <personname>
                    <firstname>Johan</firstname>
                    <surname>Persson</surname>
                </personname>
                <email>johanp@aditus.nu</email>
            </author>
        </info>
        <refmeta>
            <refentrytitle>tvpvrd</refentrytitle>
            <manvolnum>1</manvolnum>
            <refmiscinfo class="version">@VERSION@</refmiscinfo>
            <refmiscinfo class="source">http://aditus.nu/tvpvrd</refmiscinfo>
            <refmiscinfo class="manual">http://aditus.nu/tvpvrd/docs</refmiscinfo>
        </refmeta>
        <refnamediv>
            <refname>tvpvrd</refname>
            <refpurpose>TV Personal Video Recorder Server/Daemon</refpurpose>
        </refnamediv>
        <refsynopsisdiv xml:id="tvpvrd.synopsis">
            <title>Synopsis</title>
            <cmdsynopsis>
                <command>tvpvrd</command>
                <arg choice="opt">options...</arg>
            </cmdsynopsis>
        </refsynopsisdiv>
        <refsect1 xml:id="tvpvrd.options">
            <title>Arguments</title>
            <para>The following arguments are supported</para>
            <variablelist>
                <varlistentry>
                    <term><option>-d</option>,<option>--daemon</option>
                            [<emphasis>y</emphasis>|<emphasis>n</emphasis>]</term>
                    <listitem>
                        <para>Determine whether the server should be disconnected from the
                            controlling terminal (a.k.a. running as a daemon). If the server is run
                            as a dameon the logfile cannot be 'stdout'</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-f</option>,<option>--xmldbfile</option>
                        <filename>filename</filename></term>
                    <listitem>
                        <para>Use the specified file as the database file where all the specified
                            recordings are stored in XML format.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-h</option>,<option>--help</option></term>
                    <listitem>
                        <para>Print a short help and exit.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-i</option>,<option>--inifile</option>
                        <filename>filename</filename></term>
                    <listitem>
                        <para>Use the specified file as configuration file. This will override the
                            location specified at compile time.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-l</option>,<option>--logfile</option>
                        <filename>filename</filename></term>
                    <listitem>
                        <para>Define what logfile to use. Two special names can be used
                                <filename>stdout</filename> which will cause the log to be written
                            to the stdout and <filename>syslog</filename> which will cause the logs
                            to be written using the defauilt system log.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>
                        <option>-p</option>, <option>--port</option>
                    </term>
                    <listitem>
                        <para>Specify TCP/IP port number</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-V</option>,<option>--verbose</option>
                            [<emphasis>0</emphasis>|<emphasis>1</emphasis>|<emphasis>2</emphasis>]</term>
                    <listitem>
                        <para>Log verbosity level. 0 will only log error messages, 1 will log error
                            and info messages, 2 will log errors, info and additional debug
                            messages.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-v</option>, <option>--version</option></term>
                    <listitem>
                        <para>Print program version information and exit.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><option>-x</option>,<option>--xawtvrc</option>
                        <filename>filename</filename></term>
                    <listitem>
                        <para>Use the specified file to read the station names. The station name
                            file maps the standardized frequency channel names to the more commonly
                            used station names. It makes a lot more sense to specify a recording by
                            using the name BBC1 than specifying the frequency channel SE14. Note
                            that the specific channel location a station is using depends on where
                            you live, how your broadcasting provider is mapping the available
                            stations to frequency channels. The name 'xawtvrc' is the usual named
                            for the station file used by 'xawtv' and it is that format that is used
                            for the station file (see more on file format information below).</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </refsect1>
        <refsect1 xml:id="tvpvrd.description">
            <title>Description</title>
            <para>The
                    <citerefentry><refentrytitle>tvpvrd</refentrytitle><manvolnum>1</manvolnum></citerefentry>
                command starts a video recording server that will make use of one or more installed
                TV-Capture cards and, following a specified schedule, will record broadcasted and
                encoded streams from the capture card to disk. </para>
            <para>The orignal stored HW encoded file (from the capture card) can then be
                automatically transcoded (using
                        <citerefentry><refentrytitle>ffmpeg</refentrytitle><manvolnum>1</manvolnum></citerefentry>
                ) to a more efficient format. The specific details on both the iniitial HW encoder
                settings as well as the transcoding options are bundled in a 'profile'. </para>
            <para>Each recording is done using one (or multiple) profiles. Each recording will
                always have at least one profile. By default the distribution includes four profiles
                'high', 'normal', 'low', 'mobile'. Additional profiles can easily be added by the
                user. A profile is specified in a traditional ini-file text file stored under the
                'profiles' directory.</para>
            <para> The primary interface to the server is via a TCP/IP connection to the server
                running the program via a dedicated port (by default 9300). The server is controlled
                via a simple but efficient command language which allows manipulation of future
                recordings and various other administrative tasks. All commands are extensively
                described in the section 'Command language' below. </para>
            <para>Each recording is done using one (or multiple) profiles. Each recording will
                always have at least one profile, the primary profile. The primary profile will be
                used to adjust the settings of the MP2 HW encoder. For each secondary profile
                defined a new transcoding will be done. In this way it is possible to create
                multiple transcodeed versions of one recording, for example one high quality version
                for viewing on a computer and one low quality versions for viewing on a mobile
                device.</para>
            <para>By default the distribution includes four profiles 'high', 'normal', 'low',
                'mobile'. Additional profiles can easily be added by the user. A profile is
                specified in a traditional ini-file text file stored under the 'profiles'
                directory.</para>
            <para>The recordings specified are stored in a database which is a plain text file in
                XML format (UTF-8 encoded).</para>
            <para/>
        </refsect1>
        <refsect1>
            <title>Stations, channels and frequencies</title>
            <para>All TV stations are broadcasted on a local unique frequency. The frequency
                spectrum is divided in internationally standardized fixed with channels. This
                channel division is different depending on the geographic location. Dependng on your
                geographic location and local TV provider a station can be located on almost any of
                the available frequency channels. Hence you must be able to setup your local
                stations/frequncie of interest. </para>
            <para>The program has built in knowledge of the frequency channels for the following
                geographhic areas</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>FREQMAP_EUROPEWEST</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_EUROPEEAST</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_FRANCE</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_IRELAND</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_ITALY</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_AUSTRALIA</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_NEWZEALAND</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_USBCAST</para>
                    </listitem>
                    <listitem>
                        <para>FREQMAP_USCABLE</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>Since the program has no way to automatically know which map to use this must be
                specified in the application ini-file.</para>
            <para>In order to record a specific station the tuner on the capture card must be tuned
                to the local frequency channel used by the station. Since it is a lot easier to use
                the station names, for example "BBC1", than the official name on the frequency
                channel, e.g. SE14, the program uses a mapping file so it is possible to use station
                names when recording instead of frequency channels. </para>
            <para>In order for maximum re-use the program uses the same format of the
                station/channel mapping file as is done in 'xawtvrc'. This is a plain text file
                using ini-file format. In the distribution an example file is included. Unless you
                happen to live in northern Stockholm with the same TV provider as me you must change
                this to matchj your local settings. Normally your TV prpovider provides a channel
                plan for your area. Unfortunately, to make things a bit more difficult some
                broadcasting company is not following the international naming convention. </para>
            <para/>
        </refsect1>
        <refsect1>
            <title>Commands</title>
            <para>The following is a list and detailed explanation fo the recognized commands.
                Commands are specified by 1 to 3 letters. It is possible to get more detailed
                help/information for each command by giving the help command 'h' followed by the
                command, e.g. 'h l', will give more detailed help on the 'list' command.</para>
            <para>
                <variablelist>
                    <varlistentry>
                        <term>'<command>h</command>' - Help command</term>
                        <listitem>
                            <para>Print a summary of all commands available</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>v</command>' - Version command</term>
                        <listitem>
                            <para>Print program version and name</para>
                            <para>Output example:</para>
                            <screen>tvpvrd 1.0.0 (Nov 19 2009)
Compiled with Large File Support (files > 2GB).</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>t</command>' - Current Time and Date command</term>
                        <listitem>
                            <para>Print current time and date on server</para>
                            <para>Output example:</para>
                            <screen>Fri Nov 20 15:51:20 2009</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>s</command>' - Server status command</term>
                        <listitem>
                            <para>Print a summary of the server status. This includes when the
                                tvpvrd was started, how long it has been running for, the current
                                server load, a list of the clients currently connected to the
                                server.</para>
                            <para>Output example:</para>
                            <screen>   Current time: Fri Nov 20 15:45:04 2009
        Started: Thu Nov 19 14:00:19 2009
         Uptime: 25:44:45
    Server load: 0.0 0.0 0.3
        Clients: #01: 127.0.0.1, Fri Nov 20 15:44:52 2009</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>st</command>' - Print profile statistics</term>
                        <listitem>
                            <para>Print transcoding statistics for the defined profiles. This
                                statistcs is gathered for every transcoding made. The statistics
                                includes among other things the running time and average size per
                                minute of the original MP2 and the transcoded file. The statistics
                                for the transcoding can be used to predict how long time a
                                transcoding will take. However since it is highly dependent on the
                                load on the server it can be difficult to accurately predict the
                                transcoding time.</para>
                            <para>Output example:</para>
                            <screen>profile_name            : 'normal'
transcoding_speed       : 44 s transcoded / min
mp2size_1min            : 27.5 Mb/min
mp4size_1min            : 6.4 Mb/min
comp_ratio              : 4.3
total_ttime             : 3481 min
total_mp2time           : 1779 min
total_mp2files          : 31
total_mp4files          : 31</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>rst</command>' - Reset statistics command</term>
                        <listitem>
                            <para>Reset all statistcs, i.e. set all statistics to 0</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>vc</command> [0|1|2|3|4]' - Video Card command</term>
                        <listitem>
                            <para>Print information on the specified video/capture cards. The
                                command will print information on all available cards if no specific
                                card number is specified</para>
                            <para>Output example:</para>
                            <screen>Card 00: Hauppauge WinTV PVR-350, driver=ivtv v1.4.1
Card 01: Hauppauge WinTV PVR-150, driver=ivtv v1.4.1</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>l</command>' - List command</term>
                        <listitem>
                            <para>List all upcomming recordings.</para>
                            <para>Output example:</para>
                            <screen>[160|tv4    |2010-03-09|21:00|21:59|House (16/20)                 |@normal]
[135|kanal5 |2010-03-11|21:00|21:59|Criminal minds (16/20)        |@normal]
[038|kanal5 |2010-03-11|22:00|22:59|Fringe (17/20)                |@normal]
[088|kanal5 |2010-03-14|22:25|23:19|Supernatural (18/21)          |@normal]
[161|tv4    |2010-03-16|21:00|21:59|House (17/20)                 |@normal]
[136|kanal5 |2010-03-18|21:00|21:59|Criminal minds (17/20)        |@normal]
[039|kanal5 |2010-03-18|22:00|22:59|Fringe (18/20)                |@normal]</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>ls</command>' - List stations command</term>
                        <listitem>
                            <para>List all defined station names. The stations are specified in the
                                    <filename>xawtvrc</filename> file and are name frequency
                                channels. When defining the frequency for a recording either the
                                defined station name or channel (frequency) name can be used.</para>
                            <para>Output example:</para>
                            <screen>  SE11: kanal5
    57: kanal8
   S36: kanal9
   SE6: lokalkanalen
  SE16: mtv
   E10: svt24
  SE13: svtb/kunsk
    E5: tv1
    E7: tv2
   E11: tv3
    E6: tv4
  SE14: tv4+
    E8: tv6</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>lc</command> [<emphasis>card</emphasis>]' - List all video
                            capture card controls command</term>
                        <listitem>
                            <para>This can be considered a low level command of really limited use
                                for an end user. This command will list all user controllable
                                controls that can be adjusted on the specified video card. This is
                                directly related to the discovered 'v4l2' interfaces.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>n</command>' - Next recording command</term>
                        <listitem>
                            <para>List the immediate next recording scheduled for each available
                                video card. The first number in paranthesis is how long time until
                                the recording will start.</para>
                            <para>Output example:</para>
                            <screen>(01:37) : [002|tv3    |2009-11-20|18:00|18:59|NCIS_18 (02/20)               |@normal]
(52:37) : [143|tv4    |2009-11-22|21:00|22:00|Shooter 1                     |@normal]</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>o</command>' - Ongoing recordings command</term>
                        <listitem>
                            <para>List all ongoing recording in ordinary list format for all video
                                cards. If no recordings are ongoing the output will show
                                "None"</para>
                            <para>Output example:</para>
                            <screen>Video #0: [175|tv1    |2009-11-20|16:26|16:27|tv1_20091120_1626             |@normal]
Video #1: None.</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>ot</command>' - Ongoing transcodings command</term>
                        <listitem>
                            <para>List all ongoing transcodings</para>
                            <para>Output example:</para>
                            <screen>[#00|16:27|(00:00)|tv1_20091120_1626.mpg              |normal]</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>otl</command>' - Ongoing transcoding long command</term>
                        <listitem>
                            <para>List all ongoing transcoding and print the output in long format
                                which includes the detailed 'ffmpeg' command used.</para>
                            <para>Output example:</para>
                            <screen>[#00|16:27|(00:00)|tv1_20091120_1626.mpg              |normal]
(cmd: /usr/bin/ffmpeg -v 0 -i tv1_20091120_1626.mpg -threads 0 
-vcodec libx264 -vpre normal -b 700k -bt 1000k  -croptop 8 -cropbottom 8 
-cropleft 2 -cropright 2  -acodec copy -ab 196k  -y  
tv1_20091120_1626.mp4 > /dev/null 2>&amp;1)</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>kt</command>' - Kill allgoing transcoding command</term>
                        <listitem>
                            <para>Stop any ongoing transcodings.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>ktf</command>
                            [<emphasis>y</emphasis>|<emphasis>n</emphasis>]' - Kill transcoding flag
                            set/unset command</term>
                        <listitem>
                            <para>The kill transcoding flag determines wheter or not the transcoding
                                processes should be killed if the server is stopped. By default all
                                transcoding processes are killed when the tvpvrd server is killed.
                                By setting this flag to 'n' (No) the transcodinf processes will be
                                allowed to keep running after the server is stopped.</para>
                            <para>Output example:</para>
                            <screen>ktf n
killflag=n</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>z</command>' - Display all ini-file settings command</term>
                        <listitem>
                            <para>This will list all settings made in the ini-file as well as the
                                location of the ini file.</para>
                            <para>Output example:</para>
                            <screen>datadir                 : /data/pvr
logfile                 : /tmp/tvpvrd.log
inifile_name            : /etc/tvpvrd/tvpvrd.conf
xmldbfile_name          : /data/pvr/xmldb/tvpvrd_db.xml
max_video               : 2
max_entries             : 1024
max_clients             : 2
client_idle_time        : 1800s
port                    : 9300
time_resolution         : 3s
video_buffer_size       : 200000 (0.2MB)
default_recording_time  : 00:59 (h:min)
xawtv_station file      : /etc/X11/xawtvrc
default_profile         : normal</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>zp</command> [<emphasis>@profile</emphasis>]' - Display
                            profile information command</term>
                        <listitem>
                            <para>Display information on the settings of the specified
                                profile</para>
                            <para>Output example:</para>
                            <screen>                     name: normal
ENCODER:
            video_bitrate: 3400000
       video_peak_bitrate: 4000000
           audio_sampling: 44.1
            audio_bitrate: 192
                   aspect: 4x3
                     size: vga
FFMPEG:
            video_bitrate: 700
       video_peak_bitrate: 1000
                   vcodec: libx264
                     vpre: normal
                     pass: 1
                   acodec: copy
            audio_bitrate: 196
               video_size:
                     crop: (l=2, r=2, t=8, b=8)
     ffmpeg_extra_options:
           file_extension: .mp4</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>!</command> [<emphasis>#videocard</emphasis>]' - Stop
                            recording on specified video card</term>
                        <listitem>
                            <para>Stop the recording on the specified video card.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>u</command>' - Update database file command</term>
                        <listitem>
                            <para>Force update of the database file from memory.</para>
                            <para>Output example:</para>
                            <screen>Database successfully updated '/data/pvr/xmldb/tvpvrd_db.xml'</screen>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>x</command>' - View XML database command</term>
                        <listitem>
                            <para>View the current specified recordings in XML DB format.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>a</command>' - Add recording command</term>
                        <listitem>
                            <para>Add new recording. The date/timje logic is fairly complete and
                                will for example correctly handle date crossings whea recording
                                starts and ends on different sides on the midnight. For all
                                recording formats both title and profile might be omitted. In such
                                case the title will be constructed fom the station/channel name and
                                the start date/time.</para>
                            <para>For all variants the start and end time is specified as</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para><emphasis>hh</emphasis> [:<emphasis>mm</emphasis>
                                                [:<emphasis>ss</emphasis>]]</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                            <para>The maximum length for one recording is 4 hours in order to keep
                                the file size managable.</para>
                            <para>The primary formats are described below. The syntactic element
                                used have the following meaning:</para>
                            <para>&lt;ch> = Channel or station name</para>
                            <para>&lt;starttime> = Time for recording start</para>
                            <para>&lt;endtime> = Time for recording end</para>
                            <para>&lt;title> = Title of recording. This will also be used as the
                                filename of the resulting file. Note that the filename will always
                                be converted to lower caase.</para>
                            <para>&lt;@profile> = Name of the profile(s) to be used to the
                                recording. Up to 4 profiles can be specified for each recording. </para>
                            <para>
                                <variablelist>
                                    <varlistentry>
                                        <term><emphasis>a &lt;ch> &lt;starttime> [&lt;title>]
                                                [&lt;@profile]</emphasis></term>
                                        <listitem>
                                            <para>Specification of only start time. The end time
                                                will match the default recording length as specified
                                                in the ini-file.</para>
                                            <para>If the start time is after the current time the
                                                date will be assumed to be today. If the time is
                                                earlier than the current time the date is assumed to
                                                be tomorrow.</para>
                                            <para>If no title is specified the title will be
                                                constructed from the station/channel name and the
                                                start date and time.</para>
                                            <para>If no profile is specified then the default
                                                profile specified in the ini-file will be
                                                used.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry>
                                        <term><emphasis>a &lt;ch> &lt;starttime> &lt;endtime>
                                                [&lt;title>] [&lt;@profile]</emphasis></term>
                                        <listitem>
                                            <para>Specifictaion of both start and end time.</para>
                                            <para>If the start time is after the current time the
                                                date will be assumed to be today. If the time is
                                                earlier than the current time the date is assumed to
                                                be tomorrow.</para>
                                            <para>If no title is specified the title will be
                                                constructed from the station/channel name and the
                                                start date and time.</para>
                                            <para>If no profile is specified then the default
                                                profile specified in the ini-file will be
                                                used.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry>
                                        <term><emphasis>a &lt;ch> &lt;startdate> &lt;starttime>
                                                &lt;endtime> [&lt;title>]
                                            [&lt;@profile]</emphasis></term>
                                        <listitem>
                                            <para>Full date and time specification. The date can be
                                                specified as</para>
                                            <para>
                                                <itemizedlist>
                                                  <listitem>
                                                  <para><emphasis>yyyy-mm-dd</emphasis></para>
                                                  <para>Numercal date yyyy=year, mm=month [1-12],
                                                  dd=day [1-31]</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>[<emphasis>today</emphasis>|<emphasis>tomorrow</emphasis>|<emphasis>mon</emphasis>|<emphasis>tue</emphasis>|<emphasis>wed</emphasis>|<emphasis>thu</emphasis>|<emphasis>fri</emphasis>|<emphasis>sat</emphasis>|<emphasis>sun</emphasis>]</para>
                                                  <para>Relative date from today. The weekday name
                                                  refers to the coming 7 days. If the same day as
                                                  the current day is given then this refers to 7
                                                  days in the future.</para>
                                                  </listitem>
                                                </itemizedlist>
                                            </para>
                                            <para>If the start time is after the current time the
                                                date will be assumed to be today. If the time is
                                                earlier than the current time the date is assumed to
                                                be tomorrow.</para>
                                            <para>If no title is specified the title will be
                                                constructed from the station/channel name and the
                                                start date and time.</para>
                                            <para>If no profile is specified then the default
                                                profile specified in the ini-file will be
                                                used.</para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </para>
                            <para>Examples:</para>
                            <screen>a bbc1 19:30</screen>
                            <para>Start a recording at 19:30 on station BBC1 which will have the
                                default duration, default title and profile. </para>
                            <screen>a bbc1 19:30 21:15 News </screen>
                            <para>Start a recording at 19:30 which will last until 21:15 on BBC1
                                with title set to "News". The default profile will be used. </para>
                            <screen>a ch4 wed 22:00 23:45 The Movie </screen>
                            <para>Start a recording the coming Wednesday at 22:00 until 23:45 on CH4
                                with title "The Movie". The default profile will be used. </para>
                            <screen>a bbc2 tomorrow 18 20 "World in Focus" @mobile </screen>
                            <para>Start a recording tomorrow at 18:00 until 20:00 on bbc2 with title
                                "World in Focus". Using the mobile profile.</para>
                            <screen>a bbc2 tomorrow 18 20 "World in Focus" @mobile @normal</screen>
                            <para>Start a recording tomorrow at 18:00 until 20:00 on bbc2 with title
                                "World in Focus". Using both the mobile and theb normal profile.
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>q</command>' - Quick recording command</term>
                        <listitem>
                            <para>Add new recording that will start immediately. This is basically
                                the same as a simplified 'a' command where the start time and date
                                is always the current date and time.</para>
                            <para>The format of the command are</para>
                            <para>
                                <variablelist>
                                    <varlistentry>
                                        <term><emphasis>q &lt;ch> [&lt;duration>] [&lt;title>]
                                                [&lt;@profile]</emphasis></term>
                                        <listitem>
                                            <para>The recording will start within a few seconds
                                                (depending on the resolution time specifed in the
                                                ini-file) and will last for the duration specified.
                                                If no duration is specified the default duration
                                                time will be used.</para>
                                            <para> If no title is specified the title will be
                                                constructed from the station/channel name and the
                                                start date and time. </para>
                                            <para>If no profile is specified then the default
                                                profile specified in the ini-file will be used.
                                            </para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </para>
                            <para>Examples:</para>
                            <screen>q bbc2  </screen>
                            <para>Start a recording immediately on bbc2 using the default duration,
                                title and profile.</para>
                            <screen>q bbc2 1:30 </screen>
                            <para>Start a recording immediately on bbc2 with duration 1 hour 30
                                minutes, using default title and default profile. </para>
                            <screen>q bbc2 News </screen>
                            <para>Start a recording immediately on bbc2 with default duration using
                                the title "News" and defgault profile.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>ar</command>' - Add repeated command</term>
                        <listitem>
                            <para>Add a new repeated recording . The syntax is identical to the
                                normal add command with the eception of the first two
                                arguments.</para>
                            <para>
                                <variablelist>
                                    <varlistentry>
                                        <term><emphasis>ar &lt;repeat-type> &lt;repeat-count>
                                                &lt;normal add arguments></emphasis></term>
                                        <listitem>
                                            <para><emphasis>repeat-type</emphasis></para>
                                            <para>This specifies how often the repetition should be
                                                done. This can be specified as one of the following
                                                arguments:</para>
                                            <para>
                                                <itemizedlist>
                                                  <listitem>
                                                  <para>'d' - Repeat daily</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>'w' - Repeat weekly</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>'m' - repeat monthly</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>'f' - Repat Monday to Friday</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>'s' - Repeat every Saturday to Sunday</para>
                                                  </listitem>
                                                </itemizedlist>
                                            </para>
                                            <para><emphasis>repeat-cnt</emphasis></para>
                                            <para>This specifies the number of repeated
                                                recordings</para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </para>
                            <para>Since ony one title is given for multiple recording the titles
                                will be mangled with bthe recording date and time. In the redcording
                                list the title will usually be shown as "Base title (xx/yy)" where
                                xx is the sequence number and yy is the total number of recordings
                                in this sequence.</para>
                            <para>Examples:</para>
                            <screen>ar f 10 bbc1 18 18:30 News</screen>
                            <para>Start recording every Mon-Tue at BBC1 between 18:00 and
                                18:30</para>
                            <screen>ar w 20 tv1 tue 21:15 22:10 John Adams</screen>
                            <para>Start a recording once a week on Tuesday evening at 21:15 until
                                22:10 with base title "John Adams". </para>
                            <screen>ar s 10 BBC1 01:00 02:30 Night movie </screen>
                            <para>Add a recording every weekend night between 01:00 and 02:30 with
                                the base title "Night movie". The recording will be done for the
                                next 5 weekends (2 recordings each weekend).</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>d</command>
                            <emphasis>nnn</emphasis>' - Delete specified recording</term>
                        <listitem>
                            <para>Delete specified recording.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>dr</command>
                            <emphasis>nnn</emphasis>' - Delete all repeted recordings</term>
                        <listitem>
                            <para>Delete all repeated recording that are part of the same repeating
                                sequence as the id of the recording specified.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>rp</command>' - Refresh profiles command</term>
                        <listitem>
                            <para>This command will cause the profiles to be re-read from profile
                                files.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>'<command>sp</command>
                            <emphasis>nnn</emphasis>
                            <emphasis>@profile</emphasis>' - Set profile command</term>
                        <listitem>
                            <para>Specify the profiles to be used on the specified recording.</para>
                            <para>Examples:</para>
                            <screen>sp 87 @normal @mobile</screen>
                            <para>Use profiles normal and mobile for recording #87</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </para>
        </refsect1>
        <refsect1 xml:id="tvpvrd.files">
            <title>Files</title>
            <para>Note: The system configuration directory to be used is a compile time settings and
                specified with the 'configuration' argument '--sysconfdir'. </para>
            <variablelist>
                <varlistentry>
                    <term>xawtvrc</term>
                    <listitem>
                        <para>A list in ini-file format which maps the commonly known sation name to
                            a frequency channel</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>/etc/tvpvrd</term>
                    <listitem>
                        <para>Deafult configuration directory</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>/etc/tvpvrd/tvpvrd.conf</term>
                    <listitem>
                        <para>Default configuration file</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>/etc/tvpvrd/profiles/</term>
                    <listitem>
                        <para>Directory with all profiles</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/</term>
                    <listitem>
                        <para>Directory where all recordings and temporary files are stored. The
                            root directory is specified in the configuration file. </para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/vtmp</term>
                    <listitem>
                        <para>Video temporary directory. Used to store ongoing recordings and as
                            working directories while doing transcoding</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/mp2</term>
                    <listitem>
                        <para>If the profile specifies that the original mp2 files should be kept
                            they are stored in this directory.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/mp4</term>
                    <listitem>
                        <para>The transcoded files are stored under this folder in a subfolder with
                            the name of the profile used for the transcoding.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/xmldb</term>
                    <listitem>
                        <para>The database files are stored under this directory</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>&lt;data-directory>/stats</term>
                    <listitem>
                        <para>The statistics for each profile is stored in a file in XML format with
                            the same name as the profile and with the suffix '.stats'.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </refsect1>
        <refsect1>
            <title>Bugs/Limitations</title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>Numerical dates must be specified in European format,
                            yyyy-mm-dd</para>
                    </listitem>
                    <listitem>
                        <para>Not all international defined frequency maps are included</para>
                    </listitem>
                </itemizedlist>
            </para>
        </refsect1>
        <refsect1>
            <title>Author</title>
            <para>Johan Persson, &lt;johan162@gmail.com></para>
        </refsect1>
        <refsect1 xml:id="tvpvrd.seealso">
            <title>See also</title>
            <para><citerefentry>
                    <refentrytitle>tvpvrd</refentrytitle>
                    <manvolnum>5</manvolnum>
                </citerefentry></para>
        </refsect1>
    </refentry>
</article>
